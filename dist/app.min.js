angular.module("tasks",["ui.router","kinvey"]),angular.module("tasks").controller("tasksController",["$scope","$state","$kinvey","tasks","activeUser",function(e,o,n,t,r){e.tasks=t,console.log(r),e.hasActiveUser=null!==r?!0:!1,e.isAdmin=r.admin?!0:!1,e.approve=function(o,t,r){var a={_id:r,approved:o};n.DataStore.save("task-approval",a).then(function(o){console.log("Task approval/disapproval success"),e.tasks[t].approval=o},function(e){console.log("Couldnot approve the task!... see the error log below..."),console.log(e)})}}]).controller("addTaskController",["$scope","$state","$kinvey",function(e,o,n){e.addTask=function(){if(e.addTaskForm.taskName.$error.required||e.addTaskForm.startDate.$error.required||e.addTaskForm.endDate.$error.required)return null;var t={task_name:e.task.name,start_date:e.task.startDate,end_date:e.task.endDate,comments:e.task.comments};n.DataStore.save("tasks",t).then(function(){o.go("root.tasks",{},{reload:!0})},function(e){console.log("There seems to be a problem adding the task!...see the error log below..."),console.log(e)})}}]),angular.module("tasks").config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("root.tasks",{url:"/tasks",resolve:{activeUser:["$kinvey",function(e){return e.getActiveUser()}],tasks:["$kinvey",function(e){return e.DataStore.find("tasks",null,{relations:{approval:"task-approval"}}).then(function(e){return console.log("Fetched records"),console.log(e),e},function(e){console.log("Some error fetching the records!...see log below..."),console.log(e)})}]},views:{"section@root":{templateUrl:"partials/tasks.html",controller:"tasksController"}}}).state("root.tasks.addtask",{url:"/addtask",views:{"section@root":{templateUrl:"partials/add-task.html",controller:"addTaskController"}}})}]),angular.module("main",["ui.router","kinvey","tasks","login"]),angular.module("main").config(["$stateProvider","$urlRouterProvider",function(e,o){o.otherwise("/"),e.state("root",{views:{body:{templateUrl:"partials/body.html"},"header@root":{templateUrl:"partials/main-nav.html"}}})}]),angular.module("login",["ui.router","kinvey"]),angular.module("login").run(["$kinvey","$state",function(e,o){function n(e,o){var n=e.getActiveUser();console.log("Determining behaviour..."),null!==n?(console.log("Active user confirmed...redirecting to root state..."),o.go("root.tasks")):(console.log("No active user...redirecting to login page..."),o.go("root.login"))}e.init({appKey:"kid_Wk8MsXwikg",appSecret:"68c9a63e8a4a41b98898796652bfccc5"}).then(function(){return console.log("Kinvey initalized...checking for active user"),n(e,o)},function(t){return console.log("Kinvey could not be initalized (see error log below)...determining behaviour"),console.log(t),n(e,o)})}]),angular.module("login").controller("loginController",["$scope","$state","$kinvey","activeUser",function(e,o,n,t){null!==t?(e.hasActiveUser=!0,e.username=t.username,e.isAdmin=t.admin?!0:!1):e.hasActiveUser=!1,e.login=function(){return e.loginForm.username.$error.required||e.loginForm.password.$error.required?null:void n.User.login({username:e.user.name,password:e.user.pwd}).then(function(e){console.log("Successfully logged in!"),console.log(e),o.reload()},function(e){console.log("Error logging in!"),console.log(e),o.reload()})},e.logout=function(){n.User.logout().then(function(){console.log("Successfully logged out!"),o.reload()},function(e){console.log("Some problem logging out...try again!"),console.log(e),o.reload()})}}]),angular.module("login").config(["$stateProvider",function(e){e.state("root.login",{url:"/login",resolve:{activeUser:["$kinvey",function(e){return e.getActiveUser()}]},views:{"header@root":{templateUrl:"partials/login-header.html"},"section@root":{templateUrl:"partials/login.html",controller:"loginController"}}})}]);var environment=function(){var e="browser";return{agent:e,readyEvent:"webview"===e?"deviceready":"DOMContentLoaded"}}();console.log("environment "+JSON.stringify(environment));var app=new function(){function e(){console.log("Bootstrapping angular on main module..."),angular.bootstrap(document,["main"])}function o(){console.log("Ready event binding"),document.addEventListener(environment.readyEvent,e,!1)}return{initialize:function(){console.log("Initializing app by binding handlers to different events that the app responds to..."),o()}}};app.initialize();